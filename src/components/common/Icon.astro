---
import { optimize } from 'svgo'

interface Props {
  // `src/assets/icons`にあるSVGのファイル名
  name: string

  // `aria-label`に指定するテキスト
  alt: string

  class?: string
}

const { name, alt, ...attrs } = Astro.props

// 一度 string として確定させる
const path = `../../assets/icons/${name}.svg?raw`
const svgContent = (await import(path)).default

const { data: optimizedSvgContent } = optimize(svgContent, {
  plugins: [
    {
      name: 'preset-default',
      params: {
        overrides: {
          convertPathData: false,
          removeViewBox: false,
        },
      },
    },
    'removeDimensions',
    {
      name: 'addAttributesToSVGElement',
      params: {
        attribute: {
          role: 'img',
          'aria-label': alt,
          ...attrs,
        },
      },
    },
  ],
})
---

<Fragment set:html={optimizedSvgContent} />
